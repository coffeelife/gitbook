
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Taro小程序开发学习 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Taro小程序dva框架开发学习.html" />
    
    
    <link rel="prev" href="RN中场景一之RN和原生交互.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Android组件化开发.html">
            
                <a href="Android组件化开发.html">
            
                    
                    Android组件化开发
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Android开发工具之OKHttp日志抓取.html">
            
                <a href="Android开发工具之OKHttp日志抓取.html">
            
                    
                    Android开发工具之OKHttp日志抓取（仿IOS DBDebugToolkit)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="Android开发工具之环境切换.html">
            
                <a href="Android开发工具之环境切换.html">
            
                    
                    Android开发工具之环境切换
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="热更新在Cordova平台的实践.html">
            
                <a href="热更新在Cordova平台的实践.html">
            
                    
                    热更新(HotCode)在Cordova平台的实践
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="ES6新特性学习.html">
            
                <a href="ES6新特性学习.html">
            
                    
                    ES6新特性学习
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="H5常见router.html">
            
                <a href="H5常见router.html">
            
                    
                    H5常见router
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="webpack使用学习.html">
            
                <a href="webpack使用学习.html">
            
                    
                    webpack使用学习
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="Web安全问题之CSRF和XSS.html">
            
                <a href="Web安全问题之CSRF和XSS.html">
            
                    
                    Web安全问题之CSRF和XSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="路由系统重构文档.html">
            
                <a href="路由系统重构文档.html">
            
                    
                    路由系统重构文档
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="前端干货：JS的执行顺序.html">
            
                <a href="前端干货：JS的执行顺序.html">
            
                    
                    前端干货：JS的执行顺序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="前端学习之路.html">
            
                <a href="前端学习之路.html">
            
                    
                    前端学习之路
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="热更新HotCode在Cordova平台的实践.html">
            
                <a href="热更新HotCode在Cordova平台的实践.html">
            
                    
                    热更新(HotCode)在Cordova平台的实践
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="Android开发工具之OKHttp日志抓取之升级版.html">
            
                <a href="Android开发工具之OKHttp日志抓取之升级版.html">
            
                    
                    Android开发工具之OKHttp日志抓取之升级版
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="Android原生Table组件开发整理.html">
            
                <a href="Android原生Table组件开发整理.html">
            
                    
                    Android原生Table组件开发整理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="Gitlab.html">
            
                <a href="Gitlab.html">
            
                    
                    Gitlab CI/CD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="RN中场景一之RN和原生交互.html">
            
                <a href="RN中场景一之RN和原生交互.html">
            
                    
                    RN中场景一之RN和原生交互
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.18" data-path="Taro小程序开发学习.html">
            
                <a href="Taro小程序开发学习.html">
            
                    
                    Taro小程序开发学习
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="Taro小程序dva框架开发学习.html">
            
                <a href="Taro小程序dva框架开发学习.html">
            
                    
                    Taro小程序dva框架开发学习
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Taro小程序开发学习</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="taro&#x5C0F;&#x7A0B;&#x5E8F;&#x5F00;&#x53D1;&#x5B66;&#x4E60;">Taro&#x5C0F;&#x7A0B;&#x5E8F;&#x5F00;&#x53D1;&#x5B66;&#x4E60;</h1>
<p>&#x672C;&#x7BC7;&#x4ECB;&#x7ECD;&#x7684;&#x662F;Taro&#x5C0F;&#x7A0B;&#x5E8F;&#x5F00;&#x53D1;&#xFF0C;&#x4EC5;&#x4F9B;&#x5B66;&#x4E60;&#x53C2;&#x8003;&#x3002;&#x4F7F;&#x7528;&#x7684;&#x6846;&#x67B6;&#x662F;Taro(3.3.9)+dva+Taro UI&#x67B6;&#x6784;&#x5F00;&#x53D1;&#xFF0C;&#x5176;&#x4E2D;&#x5C01;&#x88C5;&#x4E86;dva&#x6846;&#x67B6;&#x6765;&#x7BA1;&#x7406;&#x6574;&#x4E2A;&#x5E94;&#x7528;&#x7684;state&#xFF0C;&#x57FA;&#x4E8E;Taro UI&#x8FDB;&#x884C;&#x7EC4;&#x5EFA;&#x5F00;&#x53D1;&#xFF0C;&#x5C01;&#x88C5;&#x4E86;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x65B9;&#x6CD5;&#xFF08;&#x5927;&#x90E8;&#x5206;&#x501F;&#x9274;&#x7F51;&#x7EDC;&#xFF09;&#xFF0C;&#x7F51;&#x7EDC;&#x8FD4;&#x56DE;&#x503C;&#x8FDB;&#x884C;&#x4E86;&#x5904;&#x7406;&#xFF0C;&#x65B9;&#x4FBF;&#x6570;&#x636E;&#x5904;&#x7406;&#x3002;</p>
<p>Taro&#x94FE;&#x63A5;:<a href="https://taro-docs.jd.com/taro/docs/README/index.html" target="_blank">https://taro-docs.jd.com/taro/docs/README/index.html</a></p>
<p>Taro UI&#x94FE;&#x63A5;&#xFF1A;<a href="https://taro-ui.jd.com/#/docs/introduction" target="_blank">https://taro-ui.jd.com/#/docs/introduction</a></p>
<p>Taro Demo&#x94FE;&#x63A5;(Gitee)&#xFF1A;<a href="https://gitee.com/guomeng/taro-dva-demo.git" target="_blank">TaroDvaDemo: Taro+dva demo</a></p>
<p>Taro Demo&#x94FE;&#x63A5;(Github)&#xFF1A;<a href="https://github.com/coffeelife/TaroDvaDemo.git" target="_blank">https://github.com/coffeelife/TaroDvaDemo.git</a></p>
<p>Taro&#x65B0;&#x65E7;&#x7248;&#x672C;&#x8FC1;&#x79FB;&#x8BF4;&#x660E;&#xFF1A;<a href="https://taro-docs.jd.com/taro/docs/next/migration" target="_blank">https://taro-docs.jd.com/taro/docs/next/migration</a></p>
<p>&#x9879;&#x76EE;&#x7EC4;&#x6210;&#x4ECB;&#x7ECD;</p>
<ul>
<li><p>UI&#xFF1A;Taro UI&#x548C;&#x539F;&#x751F;&#x7EC4;&#x4EF6;&#x7EC4;&#x6210;</p>
</li>
<li><p>dva&#xFF1A;&#x4F7F;&#x7528;redux&#x6765;&#x8FDB;&#x884C;state&#x540C;&#x610F;&#x7BA1;&#x7406;&#xFF0C;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x8FC7;&#x7A0B;&#x5C01;&#x88C5;etc</p>
</li>
<li><p>http.js&#x5C01;&#x88C5;taro&#x8BF7;&#x6C42;&#xFF0C;&#x7EDF;&#x4E00;&#x5904;&#x7406;&#x53C2;&#x6570;&#x548C;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;</p>
</li>
<li><p>&#x7248;&#x672C;&#x8BE6;&#x60C5;</p>
</li>
<li><pre><code>&quot;dependencies&quot;: {
    &quot;@babel/runtime&quot;: &quot;^7.7.7&quot;,
    &quot;@tarojs/async-await&quot;: &quot;^2.2.10&quot;,
    &quot;@tarojs/cli&quot;: &quot;3.3.9&quot;,
    &quot;@tarojs/components&quot;: &quot;3.3.9&quot;,
    &quot;@tarojs/react&quot;: &quot;3.3.9&quot;,
    &quot;@tarojs/redux-h5&quot;: &quot;^2.2.10&quot;,
    &quot;@tarojs/runtime&quot;: &quot;3.3.9&quot;,
    &quot;@tarojs/taro&quot;: &quot;3.3.9&quot;,
    &quot;babel-runtime&quot;: &quot;^6.26.0&quot;,
    &quot;dva-core&quot;: &quot;^1.6.0-beta.7&quot;,
    &quot;dva-loading&quot;: &quot;^3.0.22&quot;,
    &quot;jsrsasign&quot;: &quot;^10.4.1&quot;,
    &quot;lodash&quot;: &quot;4.17.15&quot;,
    &quot;nervjs&quot;: &quot;^1.5.7&quot;,
    &quot;react&quot;: &quot;^17.0.0&quot;,
    &quot;react-dom&quot;: &quot;^17.0.0&quot;,
    &quot;react-redux&quot;: &quot;^7.2.5&quot;,
    &quot;redux&quot;: &quot;^4.1.1&quot;,
    &quot;redux-logger&quot;: &quot;^3.0.6&quot;,
    &quot;redux-thunk&quot;: &quot;^2.3.0&quot;,
    &quot;regenerator-runtime&quot;: &quot;^0.13.9&quot;,
    &quot;taro-ui&quot;: &quot;^3.0.0-alpha.3&quot;,
    &quot;vconsole&quot;: &quot;^3.9.1&quot;
  },
</code></pre></li>
</ul>
<h2 id="&#x8BF4;&#x660E;">&#x8BF4;&#x660E;</h2>
<p>&#x56E0;&#x4E3A;&#x5E73;&#x65F6;&#x90FD;&#x662F;&#x4F7F;&#x7528;dva+antd&#x5F00;&#x53D1;&#x7F51;&#x9875;&#x3001;dva+antd mobile&#x5F00;&#x53D1;&#x624B;&#x673A;&#x7F51;&#x9875;&#x3001;dva+react native&#x5F00;&#x53D1;&#x624B;&#x673A;app&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x8003;&#x8651;&#x8FD9;&#x4E2A;&#x6846;&#x67B6;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x5728;&#x60F3;&#x81EA;&#x5DF1;&#x5982;&#x4F55;&#x65E0;&#x611F;&#x77E5;&#x6765;&#x5207;&#x6362;&#x5230;&#x5C0F;&#x7A0B;&#x5E8F;&#x5F00;&#x53D1;&#x5F53;&#x4E2D;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x50CF;&#x4F7F;&#x7528;Taro(react) + dva&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x5F00;&#x53D1;&#x5C0F;&#x7A0B;&#x5E8F;&#xFF0C;&#x7136;&#x540E;Taro&#x63D0;&#x4F9B;&#x4E86;&#x81EA;&#x5DF1;&#x7684;UI&#x5E93;Taro UI&#xFF0C;&#x6240;&#x4EE5;&#x987A;&#x4FBF;&#x4F7F;&#x7528;taro UI&#x4F5C;&#x4E3A;&#x7EC4;&#x4EF6;&#x5E93;&#x3002;</p>
<h2 id="&#x5F00;&#x53D1;&#x524D;&#x51C6;&#x5907;">&#x5F00;&#x53D1;&#x524D;&#x51C6;&#x5907;</h2>
<p>taro cli&#x5DE5;&#x5177;&#x5B89;&#x88C5;(copy&#x5B98;&#x7F51;)</p>
<pre><code># &#x4F7F;&#x7528; npm &#x5B89;&#x88C5; CLI
$ npm install -g @tarojs/cli

# OR &#x4F7F;&#x7528; yarn &#x5B89;&#x88C5; CLI
$ yarn global add @tarojs/cli

# OR &#x5B89;&#x88C5;&#x4E86; cnpm&#xFF0C;&#x4F7F;&#x7528; cnpm &#x5B89;&#x88C5; CLI
$ cnpm install -g @tarojs/cli
</code></pre><p>&#x9879;&#x76EE;&#x521D;&#x59CB;&#x5316;(copy&#x5B98;&#x7F51;)</p>
<pre><code>taro init mypp
</code></pre><p><img src="Users/gm/Library/Application%20Support/marktext/images/2021-11-12-18-07-08-image.png" title="" alt="" width="499"></p>
<p>&#x9879;&#x76EE;&#x76EE;&#x5F55;&#x7ED3;&#x6784;</p>
<p><img title="" src="Users/gm/Library/Application%20Support/marktext/images/2021-11-22-16-44-22-image.png" alt="" width="251"></p>
<pre><code>pages//&#x76EE;&#x5F55;&#x9875;&#x9762;&#x76EE;&#x5F55;
app.config,js//&#x76EE;&#x5F55;&#x4E3B;&#x914D;&#x7F6E;&#x6587;&#x4EF6;
app.js//&#x4E3B;&#x5165;&#x53E3;&#x6587;&#x4EF6;
app.less//&#x4E3B;&#x6837;&#x5F0F;&#x6587;&#x4EF6;
project.config.js//&#x5C0F;&#x7A0B;&#x5E8F;&#x914D;&#x7F6E;&#x6587;&#x4EF6;
package.json&#x4F9D;&#x8D56;&#x914D;&#x7F6E;&#x6587;&#x4EF6;
</code></pre><p><code>project.config.js</code>&#x5C06;&#x8BE5;&#x6587;&#x4EF6;&#x7684;appid&#x6539;&#x6210;&#x81EA;&#x5DF1;&#x7684;appid</p>
<pre><code>{
    &quot;miniprogramRoot&quot;: &quot;dist/&quot;,
    &quot;projectname&quot;: &quot;myapp&quot;,
    &quot;description&quot;: &quot;&#x6D4B;&#x8BD5;app&quot;,
    &quot;appid&quot;: &quot;&#x81EA;&#x5DF1;&#x7684;appId&quot;,
    &quot;setting&quot;: {
        &quot;urlCheck&quot;: true,
        &quot;es6&quot;: false,
        &quot;postcss&quot;: false,
        &quot;preloadBackgroundData&quot;: false,
        &quot;minified&quot;: false,
        &quot;newFeature&quot;: true,
        &quot;autoAudits&quot;: false,
        &quot;coverView&quot;: true,
        &quot;showShadowRootInWxmlPanel&quot;: false,
        &quot;scopeDataCheck&quot;: false,
        &quot;useCompilerModule&quot;: false
    },
    &quot;compileType&quot;: &quot;miniprogram&quot;,
    &quot;simulatorType&quot;: &quot;wechat&quot;,
    &quot;simulatorPluginLibVersion&quot;: {},
    &quot;condition&quot;: {}
}
</code></pre><p><code>npm run dev:weapp</code>&#x8FD0;&#x884C;&#x67E5;&#x770B;&#x6548;&#x679C;</p>
<p><img title="" src="Users/gm/Library/Application%20Support/marktext/images/2021-11-22-17-37-57-image.png" alt="" width="301"></p>
<h2 id="dva&#x6846;&#x67B6;&#x7684;&#x642D;&#x5EFA;">dva&#x6846;&#x67B6;&#x7684;&#x642D;&#x5EFA;</h2>
<h3 id="&#x5B89;&#x88C5;redux&#x3001;-react-redux-&#x7B49;&#x4F9D;&#x8D56;&#x5305;&#x8001;&#x7248;">&#x5B89;&#x88C5;redux&#x3001; react-redux &#x7B49;&#x4F9D;&#x8D56;&#x5305;(&#x8001;&#x7248;)</h3>
<pre><code>npm install --save react-redux

npm install --save redux @tarojs/redux @tarojs/redux-h5 redux-thunk redux-logger
</code></pre><h3 id="&#x5B89;&#x88C5;redux&#x3001;-react-redux-&#x7B49;&#x4F9D;&#x8D56;&#x5305;&#x65B0;&#x7248;">&#x5B89;&#x88C5;redux&#x3001; react-redux &#x7B49;&#x4F9D;&#x8D56;&#x5305;(&#x65B0;&#x7248;)</h3>
<p>Taro&#x65B0;&#x65E7;&#x7248;&#x672C;&#x8FC1;&#x79FB;&#x8BF4;&#x660E;&#xFF1A;<a href="https://taro-docs.jd.com/taro/docs/next/migration" target="_blank">Menu</a></p>
<pre><code>&#x4F7F;&#x7528;&#x7B2C;&#x4E09;&#x65B9; React&#x5E93;#
&#x5982;&#x679C;&#x4F60;&#x9700;&#x8981;&#x5F15;&#x5165; React &#x76F8;&#x5173;&#x751F;&#x6001;&#x7684;&#x5E93;&#xFF0C;&#x76F4;&#x63A5;&#x901A;&#x8FC7; npm install &#x5B89;&#x88C5;&#x7136;&#x540E;&#x5F15;&#x5165;&#x4F7F;&#x7528;&#x5373;&#x53EF;&#xFF0C;Taro &#x4E0D;&#x4F1A;&#x518D;&#x7EF4;&#x62A4;&#x7C7B;&#x4F3C;&#x4E8E; taro-redux &#x3001;taro-mobx &#x4E4B;&#x7C7B;&#x7684;&#x5E93;&#x3002;

// &#x5F53;&#x4F7F;&#x7528;&#x4E86; JSX &#x65F6;&#xFF0C;babel &#x4F1A;&#x9690;&#x5F0F;&#x5730;&#x8C03;&#x7528; React.createElement
// &#x56E0;&#x6B64;&#x53EA;&#x8981;&#x4F60;&#x4F7F;&#x7528;&#x4E86; JSX&#xFF0C;&#x5C31;&#x8981;&#x628A; React &#x6216; Nerv &#x5F15;&#x5165;
import React from &apos;react&apos;
import { useSelector }  from &apos;react-redux&apos;
// &#x5982;&#x679C;&#x662F;&#x4F7F;&#x7528;&#x7684;&#x662F; Nerv
// import { useSelector }  from &apos;nerv-redux&apos;
function Excited () {
  const counter = useSelector(state =&gt; state.counter)
  return ...
}
</code></pre><pre><code>npm install --save react-redux

npm install --save redux @tarojs/redux @tarojs/redux-h5 redux-thunk redux-logger
</code></pre><h3 id="&#x5B89;&#x88C5;dva">&#x5B89;&#x88C5;dva</h3>
<p>dva-core&#xFF1A;&#x5C01;&#x88C5;&#x4E86; redux &#x548C; redux-saga &#x7684;&#x4E00;&#x4E2A;&#x63D2;&#x4EF6;</p>
<p>dva-loading&#xFF1A;&#x7BA1;&#x7406;&#x9875;&#x9762;&#x7684; loading &#x72B6;&#x6001;</p>
<pre><code>npm install --save dva-core dva-loading
</code></pre><p><code>package.json</code>&#x4F9D;&#x8D56;&#x8BE6;&#x60C5;</p>
<pre><code>&quot;dependencies&quot;: {
    &quot;@babel/runtime&quot;: &quot;^7.7.7&quot;,
    &quot;@tarojs/cli&quot;: &quot;3.3.9&quot;,
    &quot;@tarojs/components&quot;: &quot;3.3.9&quot;,
    &quot;@tarojs/react&quot;: &quot;3.3.9&quot;,
    &quot;@tarojs/redux&quot;: &quot;^2.2.10&quot;,
    &quot;@tarojs/redux-h5&quot;: &quot;^2.2.10&quot;,
    &quot;@tarojs/runtime&quot;: &quot;3.3.9&quot;,
    &quot;@tarojs/taro&quot;: &quot;3.3.9&quot;,
    &quot;dva-core&quot;: &quot;^1.6.0-beta.7&quot;,
    &quot;dva-loading&quot;: &quot;^3.0.22&quot;,
    &quot;lodash&quot;: &quot;4.17.15&quot;,
    &quot;react&quot;: &quot;^17.0.0&quot;,
    &quot;react-dom&quot;: &quot;^17.0.0&quot;,
    &quot;react-redux&quot;: &quot;^7.2.6&quot;,
    &quot;redux&quot;: &quot;^4.1.2&quot;,
    &quot;redux-logger&quot;: &quot;^3.0.6&quot;,
    &quot;redux-thunk&quot;: &quot;^2.4.0&quot;,
    &quot;taro-ui&quot;: &quot;^3.0.0-alpha.3&quot;
  },
</code></pre><h3 id="&#x5728;&#x9879;&#x76EE;&#x4E2D;&#x914D;&#x7F6E;dva">&#x5728;&#x9879;&#x76EE;&#x4E2D;&#x914D;&#x7F6E;dva</h3>
<p>&#x5728;<code>src</code>&#x76EE;&#x5F55;&#x4E0B;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;<code>utils</code>&#x76EE;&#x5F55;&#xFF0C;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;<code>dva.js</code>&#x6587;&#x4EF6;&#xFF0C;&#x6587;&#x4EF6;&#x4EE3;&#x7801;&#x5982;&#x4E0B;</p>
<pre><code>import { create } from &apos;dva-core&apos;;
import { createLogger } from &apos;redux-logger&apos;;
import createLoading from &apos;dva-loading&apos;;

let app;
let store;
let dispatch;

function createApp(opt) {
  // redux&#x65E5;&#x5FD7;
  // opt.onAction = [createLogger()];
  app = create(opt);
  app.use(createLoading({}));

  if (!global.registered) opt.models.forEach(model =&gt; app.model(model));
  global.registered = true;
  app.start();

  store = app._store;
  app.getStore = () =&gt; store;

  dispatch = store.dispatch;

  app.dispatch = dispatch;
  return app;
}

export default {
  createApp,
  getDispatch() {
    return app.dispatch;
  }
}
</code></pre><p>&#x5728;<code>src</code>&#x4E0B;&#x65B0;&#x5EFA;&#x76EE;&#x5F55;<code>models</code>&#x76EE;&#x5F55;&#xFF0C;&#x91CC;&#x9762;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x9ED8;&#x8BA4;&#x7684;<code>index.js</code>&#x548C;<code>model.js</code>&#x6587;&#x4EF6;</p>
<p><code>index.js</code></p>
<pre><code>import model from &quot;./model&quot;
export default [model];
</code></pre><p><code>model.js</code></p>
<pre><code>import * as indexApi from &apos;./service&apos;;

 export default {
   namespace: &apos;index&apos;,
   state: {

   },

   effects: {
     * effectsDemo(_, { call, put }) {
       const { status, data } = yield call(indexApi.demo, {});
       if (status === &apos;ok&apos;) {
         yield put({ type: &apos;save&apos;,
           payload: {
             topData: data,
           } });
       }
     },
   },

   reducers: {
     save(state, { payload }) {
       return { ...state, ...payload };
     },
   },

 };
</code></pre><p>&#x5728;<code>src</code>&#x4E0B;&#x65B0;&#x5EFA;<code>service</code>&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5728;&#x76EE;&#x5F55;&#x4E0B;&#x65B0;&#x5EFA;<code>index.js</code>&#x6587;&#x4EF6;</p>
<p><code>service.js</code>&#x6587;&#x4EF6;</p>
<pre><code>import httpRequest from &apos;../../utils/http&apos;;

 export const demo = (data) =&gt; {
   return httpRequest.get(&quot;&quot;,data);
 };
</code></pre><h4 id="appjs&#x6539;&#x9020;">app.js&#x6539;&#x9020;</h4>
<p>&#x5C06;<code>utils</code>&#x4E0B;&#x7684;<code>dva.js</code>&#x5F15;&#x5165;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;<code>dva</code>&#x548C;<code>model</code></p>
<p><code>app.js</code></p>
<pre><code>import &quot;@tarojs/async-await&quot;;
import React, { Component } from &quot;react&quot;;
import dva from &quot;./utils/dva&quot;;
import models from &quot;./models&quot;;
import { Provider } from &quot;react-redux&quot;;
import &quot;./app.less&quot;;

const dvaApp = dva.createApp({
  initialState: {},
  models: models
});
const store = dvaApp.getStore();
// &#x5982;&#x679C;&#x9700;&#x8981;&#x5728; h5 &#x73AF;&#x5883;&#x4E2D;&#x5F00;&#x542F; React Devtools
// &#x53D6;&#x6D88;&#x4EE5;&#x4E0B;&#x6CE8;&#x91CA;&#xFF1A;
// if (process.env.NODE_ENV !== &apos;production&apos; &amp;&amp; process.env.TARO_ENV === &apos;h5&apos;)  {
//   require(&apos;nerv-devtools&apos;)
// }

export default class App extends Component {
  config={}

  componentDidMount() {}

  componentDidShow() {}

  componentDidHide() {}

  componentDidCatchError() {}

  // this.props.children &#x662F;&#x5C06;&#x8981;&#x4F1A;&#x6E32;&#x67D3;&#x7684;&#x9875;&#x9762;
  render() {
    return (
      &lt;Provider store={store}&gt;
        {this.props.children}
      &lt;/Provider&gt;
    );
  }
}
</code></pre><p>&#x65B0;&#x5EFA;<code>login</code>&#x548C;<code>index</code>&#x76EE;&#x5F55;&#x7136;&#x540E;&#x65B0;&#x5EFA;&#x5BF9;&#x5E94;&#x7684;less&#x3001;js&#x548C;config.js&#x6587;&#x4EF6;,&#x5982;&#x56FE;</p>
<p><code>login</code>&#x4E0B;&#x7684;<code>index.js</code>&#x6587;&#x4EF6;</p>
<pre><code>import React, { Component } from &quot;react&quot;;
import Taro from &quot;@tarojs/taro&quot;;
import { View, Text, Button } from &quot;@tarojs/components&quot;;
import &quot;./index.less&quot;;
import { connect } from &quot;react-redux&quot;;
import { AtButton } from &quot;taro-ui&quot;;

@connect(({ index }) =&gt; ({
  index
}))
export default class Login extends Component {
  componentDidMount() {
    console.log(this.props);
  }

  goMain = () =&gt; {
    Taro.redirectTo({ url: &quot;/pages/index/index?a=1&amp;b=2&amp;c=3&quot; });
  };

  render() {
    return (
      &lt;View className=&quot;login-page&quot;&gt;
        &#x767B;&#x5F55;&#x9875;&#x9762;
        &lt;Button className=&quot;loginBtn&quot; onClick={this.goMain}&gt;
          &#x767B;&#x5F55;
        &lt;/Button&gt;
      &lt;/View&gt;
    );
  }
}
</code></pre><p><code>index</code>&#x4E0B;&#x7684;<code>index.js</code>&#x6587;&#x4EF6;</p>
<pre><code>import React, { Component } from &quot;react&quot;;
import Taro, { getCurrentInstance } from &quot;@tarojs/taro&quot;;
import { View, Text, OpenData, Button, Textarea } from &quot;@tarojs/components&quot;;
import { connect } from &quot;react-redux&quot;;
import &quot;./index.less&quot;;

@connect(({ index }) =&gt; ({
  index
}))
export default class Index extends Component {
  state = {
    userInfo: {},
    hasUserInfo: false
  };

  componentDidMount = () =&gt; {
    Taro.hideHomeButton();
    let { router } = getCurrentInstance();
    let { a, b, c } = router.params;
    console.log(this.props, router, a, b, c);
  };

  getUserProfile = () =&gt; {
    // &#x63A8;&#x8350;&#x4F7F;&#x7528;wx.getUserProfile&#x83B7;&#x53D6;&#x7528;&#x6237;&#x4FE1;&#x606F;&#xFF0C;&#x5F00;&#x53D1;&#x8005;&#x6BCF;&#x6B21;&#x901A;&#x8FC7;&#x8BE5;&#x63A5;&#x53E3;&#x83B7;&#x53D6;&#x7528;&#x6237;&#x4E2A;&#x4EBA;&#x4FE1;&#x606F;&#x5747;&#x9700;&#x7528;&#x6237;&#x786E;&#x8BA4;
    // &#x5F00;&#x53D1;&#x8005;&#x59A5;&#x5584;&#x4FDD;&#x7BA1;&#x7528;&#x6237;&#x5FEB;&#x901F;&#x586B;&#x5199;&#x7684;&#x5934;&#x50CF;&#x6635;&#x79F0;&#xFF0C;&#x907F;&#x514D;&#x91CD;&#x590D;&#x5F39;&#x7A97;
    Taro.getUserProfile({
      desc: &quot;&#x7528;&#x4E8E;&#x5B8C;&#x5584;&#x4F1A;&#x5458;&#x8D44;&#x6599;&quot;, // &#x58F0;&#x660E;&#x83B7;&#x53D6;&#x7528;&#x6237;&#x4E2A;&#x4EBA;&#x4FE1;&#x606F;&#x540E;&#x7684;&#x7528;&#x9014;&#xFF0C;&#x540E;&#x7EED;&#x4F1A;&#x5C55;&#x793A;&#x5728;&#x5F39;&#x7A97;&#x4E2D;&#xFF0C;&#x8BF7;&#x8C28;&#x614E;&#x586B;&#x5199;
      success: res =&gt; {
        this.setState(
          {
            userInfo: res.userInfo,
            hasUserInfo: true
          },
          () =&gt; {
            Taro.showModal({
              title: &quot;&#x7528;&#x6237;&#x4FE1;&#x606F;&quot;,
              content: JSON.stringify(res.userInfo),
              showCancel: false,
              confirmText: &quot;&#x786E;&#x5B9A;&quot;
            });
          }
        );
      }
    });
  };

  render() {
    let { hasUserInfo, userInfo } = this.state;
    return (
      &lt;View className=&quot;index-page&quot;&gt;
        &lt;View className=&quot;userInfo&quot;&gt;
          &lt;OpenData className=&quot;userAvatar&quot; type=&quot;userAvatarUrl&quot; /&gt;
          &lt;View className=&quot;userDetail&quot;&gt;
            &lt;OpenData type=&quot;userNickName&quot; lang=&quot;zh_CN&quot; /&gt;
            &lt;View&gt;
              &lt;OpenData type=&quot;userGender&quot; lang=&quot;zh_CN&quot; /&gt;{&quot; &quot;}
              &lt;OpenData type=&quot;userCountry&quot; lang=&quot;zh_CN&quot; /&gt;{&quot; &quot;}
              &lt;OpenData type=&quot;userProvince&quot; lang=&quot;zh_CN&quot; /&gt;{&quot; &quot;}
              &lt;OpenData type=&quot;userCity&quot; lang=&quot;zh_CN&quot; /&gt;
            &lt;/View&gt;
          &lt;/View&gt;
        &lt;/View&gt;
        &lt;Button className=&quot;userBtn&quot; onClick={this.getUserProfile}&gt;
          &#x83B7;&#x53D6;&#x7528;&#x6237;&#x4FE1;&#x606F;
        &lt;/Button&gt;
      &lt;/View&gt;
    );
  }
}
</code></pre><p>&#x5728; <code>index</code>&#x7684;&#x4E3B;&#x6587;&#x4EF6;&#x4E2D;&#x6253;&#x5370;this.props&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5BF9;&#x5E94;&#x7684;state&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;&#x83B7;&#x53D6;&#x4E0A;&#x4E00;&#x9875;&#x4F20;&#x9012;&#x4F7F;&#x7528;&#x8FC7;<code>let { router } = getCurrentInstance();let { a, b, c } = router.params;</code>&#x6765;&#x83B7;&#x53D6;&#x3002;&#x8FD9;&#x6837;dva&#x6846;&#x67B6;&#x5C31;&#x5DF2;&#x7ECF;&#x52A0;&#x5165;&#x5230;&#x5C0F;&#x7A0B;&#x5E8F;&#x5F53;&#x4E2D;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x50CF;&#x4F7F;&#x7528;&#x7F51;&#x9875;&#x5F00;&#x53D1;&#x7684;&#x601D;&#x7EF4;&#x6765;&#x5F00;&#x53D1;&#x5C0F;&#x7A0B;&#x5E8F;&#x3002;</p>
<p><img src="Users/gm/Library/Application%20Support/marktext/images/2021-11-23-10-23-08-image.png" alt=""></p>
<h2 id="taro&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x7684;&#x5C01;&#x88C5;">taro&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x7684;&#x5C01;&#x88C5;</h2>
<p>&#x6B64;&#x5904;&#x501F;&#x9274;&#x7684;&#x662F;&#x7F51;&#x4E0A;&#x7684;demo,&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x81EA;&#x5DF1;&#x7684;&#x9700;&#x6C42;&#x6765;&#x8FDB;&#x884C;&#x5F00;&#x53D1;&#x8C03;&#x6574;&#x3002;&#x4E3B;&#x8981;&#x8BBE;&#x8BA1;&#x8BF7;&#x6C42;&#x65B9;&#x5F0F;get&#x3001;post&#x3001;put&#x3001;delete&#x7684;&#x5C01;&#x88C5;&#xFF0C;&#x62E6;&#x622A;&#x5668;&#x7684;&#x5C01;&#x88C5;&#x3001;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x7684;&#x5C01;&#x88C5;&#xFF0C;&#x7EDF;&#x4E00;&#x8FD4;&#x56DE;<code>taro.request</code>&#x8FD9;&#x90E8;&#x5206;&#x6211;&#x4EEC;&#x4F1A;&#x505A;&#x4FEE;&#x6539;&#xFF0C;&#x4E0A;&#x4EE3;&#x7801;</p>
<p><code>http.js</code></p>
<pre><code>import Taro from &quot;@tarojs/taro&quot;;
import getBaseUrl from &quot;./baseUrl&quot;;
import interceptors from &quot;./interceptors&quot;;

interceptors.forEach(interceptorItem =&gt; Taro.addInterceptor(interceptorItem));

class httpRequest {
  baseOptions(params, method = &quot;GET&quot;) {
    let { url, data } = params;
    const BASE_URL = getBaseUrl(url);
    let contentType = &quot;application/json&quot;;
    contentType = params.contentType || contentType;
    const option = {
      url: BASE_URL + url, //&#x5730;&#x5740;
      data: data, //&#x4F20;&#x53C2;
      method: method, //&#x8BF7;&#x6C42;&#x65B9;&#x5F0F;
      timeout: 50000, // &#x8D85;&#x65F6;&#x65F6;&#x95F4;
      header: {
        &quot;content-type&quot;: contentType,
        Authorization: Taro.getStorageSync(&quot;Authorization&quot;)
      }
    };
    return Taro.request(option);
  }

  get(url, data = &quot;&quot;) {
    let option = { url, data };
    return this.baseOptions(option);
  }

  post(url, data, contentType) {
    let params = { url, data, contentType };
    return this.baseOptions(params, &quot;POST&quot;);
  }

  put(url, data = &quot;&quot;) {
    let option = { url, data };
    return this.baseOptions(option, &quot;PUT&quot;);
  }

  delete(url, data = &quot;&quot;) {
    let option = { url, data };
    return this.baseOptions(option, &quot;DELETE&quot;);
  }
}

export default new httpRequest()&#xFF1B;
</code></pre><p>&#x62E6;&#x622A;&#x5668;&#x5C01;&#x88C5;<code>interceptors.js</code></p>
<pre><code>import Taro from &quot;@tarojs/taro&quot;
import { pageToLogin } from &quot;./utils&quot;
import { HTTP_STATUS } from &apos;./config&apos;

const customInterceptor = (chain) =&gt; {

  const requestParams = chain.requestParams

  return chain.proceed(requestParams).then(res =&gt; {
    // &#x53EA;&#x8981;&#x8BF7;&#x6C42;&#x6210;&#x529F;&#xFF0C;&#x4E0D;&#x7BA1;&#x8FD4;&#x56DE;&#x4EC0;&#x4E48;&#x72B6;&#x6001;&#x7801;&#xFF0C;&#x90FD;&#x8D70;&#x8FD9;&#x4E2A;&#x56DE;&#x8C03;
    if (res.statusCode === HTTP_STATUS.NOT_FOUND) {
      return Promise.reject(&quot;&#x8BF7;&#x6C42;&#x8D44;&#x6E90;&#x4E0D;&#x5B58;&#x5728;&quot;)

    } else if (res.statusCode === HTTP_STATUS.BAD_GATEWAY) {
      return Promise.reject(&quot;&#x670D;&#x52A1;&#x7AEF;&#x51FA;&#x73B0;&#x4E86;&#x95EE;&#x9898;&quot;)

    } else if (res.statusCode === HTTP_STATUS.FORBIDDEN) {
      Taro.setStorageSync(&quot;Authorization&quot;, &quot;&quot;)
      pageToLogin()
      // TODO &#x6839;&#x636E;&#x81EA;&#x8EAB;&#x4E1A;&#x52A1;&#x4FEE;&#x6539;
      return Promise.reject(&quot;&#x6CA1;&#x6709;&#x6743;&#x9650;&#x8BBF;&#x95EE;&quot;);

    } else if (res.statusCode === HTTP_STATUS.AUTHENTICATE) {
      Taro.setStorageSync(&quot;Authorization&quot;, &quot;&quot;)
      pageToLogin()
      return Promise.reject(&quot;&#x9700;&#x8981;&#x9274;&#x6743;&quot;)

    } else if (res.statusCode === HTTP_STATUS.SUCCESS) {
      return res.data

    }
  })
}

// Taro &#x63D0;&#x4F9B;&#x4E86;&#x4E24;&#x4E2A;&#x5185;&#x7F6E;&#x62E6;&#x622A;&#x5668;
// logInterceptor - &#x7528;&#x4E8E;&#x6253;&#x5370;&#x8BF7;&#x6C42;&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;
// timeoutInterceptor - &#x5728;&#x8BF7;&#x6C42;&#x8D85;&#x65F6;&#x65F6;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x3002;
const interceptors = [customInterceptor, Taro.interceptors.logInterceptor]

export default interceptors
</code></pre><p>&#x83B7;&#x53D6;&#x94FE;&#x63A5;&#x7684;&#x65B9;&#x5F0F;<code>baseUrl.js</code></p>
<pre><code>const getBaseUrl = (url) =&gt; {
  let BASE_URL = &apos;&apos;;
  if (process.env.NODE_ENV === &apos;development&apos;) {
    //&#x5F00;&#x53D1;&#x73AF;&#x5883; - &#x6839;&#x636E;&#x8BF7;&#x6C42;&#x4E0D;&#x540C;&#x8FD4;&#x56DE;&#x4E0D;&#x540C;&#x7684;BASE_URL
    if (url.includes(&apos;/api/&apos;)) {
      BASE_URL = &apos;&apos;
    } else if (url.includes(&apos;/iatadatabase/&apos;)) {
      BASE_URL = &apos;&apos;
    }
  } else {
    // &#x751F;&#x4EA7;&#x73AF;&#x5883;
    if (url.includes(&apos;/api/&apos;)) {
      BASE_URL = &apos;&apos;
    } else if (url.includes(&apos;/iatadatabase/&apos;)) {
      BASE_URL = &apos;&apos;
    }
  }
  return BASE_URL
}

export default getBaseUrl;
</code></pre><p>&#x8BF7;&#x6C42;&#x72B6;&#x6001;&#x6587;&#x4EF6;<code>config.js</code></p>
<pre><code>export const HTTP_STATUS = {
  SUCCESS: 200,
  CREATED: 201,
  ACCEPTED: 202,
  CLIENT_ERROR: 400,
  AUTHENTICATE: 401,
  FORBIDDEN: 403,
  NOT_FOUND: 404,
  SERVER_ERROR: 500,
  BAD_GATEWAY: 502,
  SERVICE_UNAVAILABLE: 503,
  GATEWAY_TIMEOUT: 504
}
</code></pre><p>&#x53EE;&#x53EE;&#xFF0C;&#x8FD9;&#x6837;&#x6574;&#x4F53;&#x7684;&#x5C01;&#x88C5;&#x5C31;&#x5B8C;&#x6210;&#x4E86;</p>
<h2 id="&#x6269;&#x5C55;">&#x6269;&#x5C55;</h2>
<h3 id="&#x6DFB;&#x52A0;&#x5206;&#x5305;">&#x6DFB;&#x52A0;&#x5206;&#x5305;</h3>
<p><img src="Users/gm/Library/Application%20Support/marktext/images/2021-11-23-11-32-47-image.png" title="" alt="" width="306"></p>
<p><code>app.config.js</code></p>
<pre><code>export default {
  pages: [
    &apos;pages/login/index&apos;,
    &apos;pages/index/index&apos;
  ],
  subPackages: [
    { root: &quot;modules&quot;, pages: [&quot;test/index&quot;, &quot;detail/index&quot;] }
  ],
  window: {
    backgroundTextStyle: &apos;light&apos;,
    navigationBarBackgroundColor: &apos;#fff&apos;,
    navigationBarTitleText: &apos;WeChat&apos;,
    navigationBarTextStyle: &apos;black&apos;
  }
}
</code></pre><h3 id="http&#x8FD4;&#x56DE;&#x4FEE;&#x6539;">http&#x8FD4;&#x56DE;&#x4FEE;&#x6539;</h3>
<p>&#x7ED3;&#x679C;&#x8FD4;&#x56DE;&#x4ECE;promise&#x4FEE;&#x6539;&#x4E3A;&#x73B0;&#x5728;&#x76F4;&#x63A5;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;</p>
<p><code>http.js</code>&#x65B0;</p>
<pre><code>import Taro from &quot;@tarojs/taro&quot;;
import getBaseUrl from &quot;./baseUrl&quot;;
import { HTTP_STATUS } from &quot;./config&quot;;
import { STORAGE_DATA } from &quot;./constant&quot;;
import interceptors from &quot;./interceptors&quot;;
import { createNonceSt, MD5withRSA, pageToLogin, signjs } from &quot;./utils&quot;;

interceptors.forEach(interceptorItem =&gt; Taro.addInterceptor(interceptorItem));

class httpRequest {
  baseOptions(params, method = &quot;GET&quot;) {
    let { url, data } = params;
    //&#x6DFB;&#x52A0;token &#x968F;&#x673A;&#x6570; sign
    if (Taro.getStorageSync(STORAGE_DATA.TOKEN))
      data.token = Taro.getStorageSync(STORAGE_DATA.TOKEN);
    if (!data.retrieveIntervalTime) data.retrieveIntervalTime = 60000;
    if (!data.retrieveTime) data.retrieveTime = new Date().getTime();

    data.nonce = createNonceSt();
    data.sign = MD5withRSA(signjs(data));
    const BASE_URL = getBaseUrl(url);
    let contentType = &quot;application/json&quot;;
    contentType = params.contentType || contentType;
    const option = {
      url: BASE_URL + url, //&#x5730;&#x5740;
      data: data, //&#x4F20;&#x53C2;
      method: method, //&#x8BF7;&#x6C42;&#x65B9;&#x5F0F;
      timeout: 50000, // &#x8D85;&#x65F6;&#x65F6;&#x95F4;
      header: {
        &quot;content-type&quot;: contentType,
        Authorization: `Bearer ${Taro.getStorageSync(STORAGE_DATA.TOKEN)}`
      }
    };
    // return Taro.request(option);
    if (process.env.NODE_ENV === &quot;development&quot;) {
      console.log(
        `${new Date().toLocaleString()}&#x3010; M=${option.url} &#x3011;P=${JSON.stringify(
          option.data
        )}`
      );
    }
    return Taro.request(option)
      .then(res =&gt; {
        console.log(&quot;resres&quot;, res);
        if (res) {
          if (
            res.code &gt;= HTTP_STATUS.SUCCESS &amp;&amp;
            res.code &lt; HTTP_STATUS.MULTI_SELECT
          ) {
            if (process.env.NODE_ENV === &quot;development&quot;) {
              console.log(
                `${new Date().toLocaleString()}&#x3010; M=${
                  option.url
                } &#x3011;&#x3010;&#x63A5;&#x53E3;&#x54CD;&#x5E94;&#xFF1A;&#x3011;`,
                res
              );
            }
            return res;
          } else {
            throw new Error(
              `${res.desc || &quot;&#x7F51;&#x7EDC;&#x8BF7;&#x6C42;&#x9519;&#x8BEF;&#xFF0C;&#x72B6;&#x6001;&#x7801;&quot;}(${res.code})`
            );
          }
        } else {
          throw new Error(`&#x6570;&#x636E;&#x8FD4;&#x56DE;&#x5F02;&#x5E38;&#xFF0C;&#x8BF7;&#x91CD;&#x8BD5;`);
        }
      })
      .catch(error =&gt; {
        console.log(&quot;http error&quot;, error);
        Taro.showToast({ title: error.message || &quot;&#x670D;&#x52A1;&#x5F02;&#x5E38;&quot;, icon: &quot;none&quot; });
        // pageToLogin()
        // return null;
      });
  }

  get(url, data = &quot;&quot;) {
    let option = { url, data };
    return this.baseOptions(option);
  }

  post(url, data, contentType) {
    let params = { url, data, contentType };
    return this.baseOptions(params, &quot;POST&quot;);
  }

  put(url, data = &quot;&quot;) {
    let option = { url, data };
    return this.baseOptions(option, &quot;PUT&quot;);
  }

  delete(url, data = &quot;&quot;) {
    let option = { url, data };
    return this.baseOptions(option, &quot;DELETE&quot;);
  }
}

export default new httpRequest();
</code></pre><h3 id="&#x9A8C;&#x7B7E;&#x8FC7;&#x7A0B;&#x6DFB;&#x52A0;">&#x9A8C;&#x7B7E;&#x8FC7;&#x7A0B;&#x6DFB;&#x52A0;</h3>
<p>//&#x516C;&#x5171;&#x9A8C;&#x7B7E;</p>
<p>1 &#x516C;&#x5171;&#x9A8C;&#x7B7E;&#x65B9;&#x6CD5;&#x662F;&#x7528;&#x4E8E;&#x751F;&#x6210;&#x8BBF;&#x95EE;api&#x7684;sign&#x7B7E;&#x7684;&#x4E00;&#x4E2A;&#x516C;&#x5171;&#x65B9;&#x6CD5;&#xFF0C;&#x751F;&#x6210;&#x7684;sign&#x5C06;&#x7528;&#x4E8E;api&#x63A5;&#x53E3;&#x6709;&#x6548;&#x6027;&#x4E0E;&#x6743;&#x9650;&#x7684;&#x9A8C;&#x8BC1;&#xFF0C;&#x4EE5;&#x4FDD;&#x8BC1;&#x63A5;&#x53E3;&#x4E92;&#x901A;&#x7684;&#x5B89;&#x5168;&#x6027;&#x3002;</p>
<p>2 &#x7B7E;&#x540D;&#x7B97;&#x6CD5;&#xFF1A;</p>
<p>&#x7B7E;&#x540D;&#x751F;&#x6210;&#x7684;&#x901A;&#x7528;&#x6B65;&#x9AA4;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>&#x7B2C;&#x4E00;&#x6B65;&#xFF0C;&#x8BBE;&#x6240;&#x6709;&#x53D1;&#x9001;&#x6216;&#x8005;&#x63A5;&#x6536;&#x5230;&#x7684;&#x6570;&#x636E;&#x4E3A;&#x96C6;&#x5408;M&#xFF08;&#x4E0D;&#x5305;&#x542B;sign&#xFF09;&#xFF0C;&#x5C06;&#x96C6;&#x5408;M&#x5185;&#x975E;&#x7A7A;&#x53C2;&#x6570;&#x503C;&#x7684;&#x53C2;&#x6570;&#x6309;&#x7167;&#x53C2;&#x6570;&#x540D;ASCII&#x7801;&#x4ECE;&#x5C0F;&#x5230;&#x5927;&#x6392;&#x5E8F;&#xFF08;&#x5B57;&#x5178;&#x5E8F;&#xFF09;&#xFF0C;&#x4F7F;&#x7528;URL&#x952E;&#x503C;&#x5BF9;&#x7684;&#x683C;&#x5F0F;&#xFF08;&#x5373;key1=value1&amp;key2=value2&#x2026;&#xFF09;&#x62FC;&#x63A5;&#x6210;&#x5B57;&#x7B26;&#x4E32;stringA&#x3002;</p>
<p>&#x7279;&#x522B;&#x6CE8;&#x610F;&#x4EE5;&#x4E0B;&#x91CD;&#x8981;&#x89C4;&#x5219;&#xFF1A;</p>
<p>1.&#x25C6; &#x53C2;&#x6570;&#x540D;ASCII&#x7801;&#x4ECE;&#x5C0F;&#x5230;&#x5927;&#x6392;&#x5E8F;&#xFF08;&#x5B57;&#x5178;&#x5E8F;&#xFF09;&#xFF1B;</p>
<p>2.&#x25C6; &#x5982;&#x679C;&#x53C2;&#x6570;&#x7684;&#x503C;&#x4E3A;&#x7A7A;&#x4E0D;&#x53C2;&#x4E0E;&#x7B7E;&#x540D;&#xFF1B;</p>
<p>3.&#x25C6; &#x53C2;&#x6570;&#x540D;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;&#xFF1B;</p>
<p>4.&#x25C6; &#x9A8C;&#x8BC1;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x6216;&#x4E3B;&#x52A8;&#x901A;&#x77E5;&#x7B7E;&#x540D;&#x65F6;&#xFF0C;&#x4F20;&#x9001;&#x7684;sign&#x53C2;&#x6570;&#x4E0D;&#x53C2;&#x4E0E;&#x7B7E;&#x540D;&#xFF0C;&#x5C06;&#x751F;&#x6210;&#x7684;&#x7B7E;&#x540D;&#x4E0E;&#x8BE5;sign&#x503C;&#x4F5C;&#x6821;&#x9A8C;&#x3002;</p>
<p>5.&#x25C6; &#x63A5;&#x53E3;&#x53EF;&#x80FD;&#x589E;&#x52A0;&#x5B57;&#x6BB5;&#xFF0C;&#x9A8C;&#x8BC1;&#x7B7E;&#x540D;&#x65F6;&#x5FC5;&#x987B;&#x652F;&#x6301;&#x589E;&#x52A0;&#x7684;&#x6269;&#x5C55;&#x5B57;&#x6BB5;</p>
<p>&#x7B2C;&#x4E8C;&#x6B65;&#xFF0C;&#x5728;stringA&#x6700;&#x540E;&#x62FC;&#x63A5;&#x4E0A;apikey&#x5F97;&#x5230;stringSignTemp&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5E76;&#x5BF9;stringSignTemp&#x8FDB;&#x884C;MD5&#x8FD0;&#x7B97;&#xFF0C;&#x518D;&#x5C06;&#x5F97;&#x5230;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6240;&#x6709;&#x5B57;&#x7B26;&#x8F6C;&#x6362;&#x4E3A;&#x5927;&#x5199;&#xFF0C;&#x5F97;&#x5230;signMD5&#xFF0C;&#x5BF9;signMD5&#x503C;&#x8FDB;&#x884C;RSA&#x8FD0;&#x7B97;&#x5F97;&#x5230;sign&#x3002;</p>
<p>&#x4E3E;&#x4F8B;&#xFF1A;</p>
<p>&#x5047;&#x8BBE;&#x4F20;&#x9001;&#x7684;&#x53C2;&#x6570;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>appid&#xFF1A; wxd930ea5d5a258f4f</p>
<p>mch_id&#xFF1A; 10000100</p>
<p>device_info&#xFF1A; 1000</p>
<p>body&#xFF1A; test</p>
<p>nonce&#xFF1A; ibuaiVcKdpRxkhJA</p>
<p>&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x5BF9;&#x53C2;&#x6570;&#x6309;&#x7167;key=value&#x7684;&#x683C;&#x5F0F;&#xFF0C;&#x5E76;&#x6309;&#x7167;&#x53C2;&#x6570;&#x540D;ASCII&#x5B57;&#x5178;&#x5E8F;&#x6392;&#x5E8F;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>stringA=&quot;appid=wxd930ea5d5a258f4f&amp;body=test&amp;device_info=1000&amp;mch_id=10000100&amp;nonce=ibuaiVcKdpRxkhJA&quot;;</p>
<p>&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;&#x62FC;&#x63A5;API&#x5BC6;&#x94A5;&#xFF1A;</p>
<p>MD5&#x7B7E;&#x540D;&#x65B9;&#x5F0F;&#xFF1A;</p>
<p>stringSignTemp=stringA+&quot;&amp;key=192006250b4c09247ec02edce69f6a2d&quot; //&#x6CE8;&#xFF1A;key&#x4E3A;&#x7528;&#x6237;&#x7684;userCode</p>
<p>signMD5=MD5(stringSignTemp).toUpperCase()=&quot;9A0A8659F005D6984697E2CA0A9CF3B7&quot; //&#x6CE8;&#xFF1A;MD5&#x7B7E;&#x540D;&#x65B9;&#x5F0F;</p>
<p>RSA&#x7B7E;&#x540D;&#x65B9;&#x5F0F;&#xFF1A;</p>
<p>sign=RSA(signMD5,appSecret)=&quot;6A9AE1657590FD6257D693A078E1C3E4BB6BA4DC30B23E0EE2496E54170DACD6&quot;</p>
<p>&#x6CE8;&#xFF1A;</p>
<p>1 RSA&#x7B7E;&#x540D;&#x65B9;&#x5F0F;&#x4E2D;&#x7684;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x4E3A;RSA&#xFF0C;&#x7B7E;&#x540D;&#x7B97;&#x6CD5;&#x4E3A;MD5withRSA</p>
<p>2&#x751F;&#x6210;&#x968F;&#x673A;&#x6570;&#x7B97;&#x6CD5;</p>
<p>API&#x63A5;&#x53E3;&#x534F;&#x8BAE;&#x4E2D;&#x5305;&#x542B;&#x5B57;&#x6BB5;nonce&#xFF0C;&#x4E3B;&#x8981;&#x4FDD;&#x8BC1;&#x7B7E;&#x540D;&#x4E0D;&#x53EF;&#x9884;&#x6D4B;&#x3002;&#x6211;&#x4EEC;&#x63A8;&#x8350;&#x751F;&#x6210;&#x968F;&#x673A;&#x6570;&#x7B97;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;&#x8C03;&#x7528;&#x968F;&#x673A;&#x6570;&#x51FD;&#x6570;&#x751F;&#x6210;&#xFF0C;&#x5C06;&#x5F97;&#x5230;&#x7684;&#x503C;&#x8F6C;&#x6362;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<p>2.1.3&#x5B57;&#x6BB5;&#x4ECB;&#x7ECD;&#xFF1A;</p>
<p>nonce &#x968F;&#x673A;&#x6570;</p>
<p>key &#x4E3A;&#x7528;&#x6237;&#x7684;userCode</p>
<p><code>utils.js</code>&#x4E2D;&#x7684;<code>MD5withRSA</code>&#x3001;<code>signjs</code>&#x3001;<code>sortObj</code>&#x3001;<code>createNonceSt</code>&#x4E3A;&#x5C01;&#x88C5;&#x7684;&#x9A8C;&#x7B7E;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#xFF08;&#x5DF2;&#x9A8C;&#x8BC1;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#xFF09;</p>
<pre><code>import Taro from &quot;@tarojs/taro&quot;;
import md5 from &quot;./md5js&quot;;
import { STORAGE_DATA } from &quot;./constant&quot;;
import { hextob64, KEYUTIL, KJUR, RSAKey } from &quot;jsrsasign&quot;;
/**
 * @description &#x83B7;&#x53D6;&#x5F53;&#x524D;&#x9875;url
 */
export const getCurrentPageUrl = () =&gt; {
  let pages = Taro.getCurrentPages();
  let currentPage = pages[pages.length - 1];
  let url = currentPage.route;
  return url;
};

export const pageToLogin = () =&gt; {
  let path = getCurrentPageUrl();
  Taro.clearStorageSync();
  if (!path.includes(&quot;login&quot;)) {
    Taro.reLaunch({
      url: &quot;/pages/login/index&quot;
    });
  }
};

/** &#x5BF9;&#x8C61;&#x8F6C;url&#x53C2;&#x6570; */
export const stringify = params =&gt; {
  const obj = typeof params === &quot;object&quot; &amp;&amp; params !== null ? params : {};
  const isEmpty = v =&gt; v === &quot;&quot; || v === null || v === undefined;
  return Object.keys(obj)
    .filter(k =&gt; !isEmpty(obj[k]))
    .map(key =&gt; `${key}=${encodeURIComponent(obj[key])}`)
    .join(&quot;&amp;&quot;);
};

export const repeat = (str = &quot;0&quot;, times) =&gt; new Array(times + 1).join(str);
// &#x65F6;&#x95F4;&#x524D;&#x9762; +0
export const pad = (num, maxLength = 2) =&gt;
  repeat(&quot;0&quot;, maxLength - num.toString().length) + num;
/** &#x65F6;&#x95F4;&#x683C;&#x5F0F;&#x7684;&#x8F6C;&#x6362; */
export const formatTime = time =&gt;
  `${pad(time.getHours())}:${pad(time.getMinutes())}:${pad(
    time.getSeconds()
  )}.${pad(time.getMilliseconds(), 3)}`;

export var globalData = {}; // &#x5168;&#x5C40;&#x516C;&#x5171;&#x53D8;&#x91CF;

// &#x4F7F;&#x7528;es6&#x7684;padStart()&#x65B9;&#x6CD5;&#x6765;&#x8865;0
export const getYMDHMS = timestamp =&gt; {
  let time = timestamp ? new Date(timestamp) : new Date();
  let year = time.getFullYear();
  const month = (time.getMonth() + 1).toString().padStart(2, &quot;0&quot;);
  const date = time
    .getDate()
    .toString()
    .padStart(2, &quot;0&quot;);
  const hours = time
    .getHours()
    .toString()
    .padStart(2, &quot;0&quot;);
  const minute = time
    .getMinutes()
    .toString()
    .padStart(2, &quot;0&quot;);
  const second = time
    .getSeconds()
    .toString()
    .padStart(2, &quot;0&quot;);

  return (
    year +
    &quot;&#x5E74;&quot; +
    month +
    &quot;&#x6708;&quot; +
    date +
    &quot;&#x65E5; &quot; +
    hours +
    &quot;&#x65F6;&quot; +
    minute +
    &quot;&#x5206;&quot; +
    second +
    &quot;&#x79D2;&quot;
  );
};

export function getFileName(filePath) {
  if (!filePath) return null;
  let index = filePath.lastIndexOf(&quot;/&quot;);
  const name = filePath.substring(index + 1);
  return name;
}

// &#x4F7F;&#x7528;es6&#x7684;padStart()&#x65B9;&#x6CD5;&#x6765;&#x8865;0
export const getYMDHMS2 = timestamp =&gt; {
  let time = timestamp ? new Date(timestamp) : new Date();
  let year = time.getFullYear();
  const month = (time.getMonth() + 1).toString().padStart(2, &quot;0&quot;);
  const date = time
    .getDate()
    .toString()
    .padStart(2, &quot;0&quot;);
  const hours = time
    .getHours()
    .toString()
    .padStart(2, &quot;0&quot;);
  const minute = time
    .getMinutes()
    .toString()
    .padStart(2, &quot;0&quot;);
  const second = time
    .getSeconds()
    .toString()
    .padStart(2, &quot;0&quot;);

  return (
    year + &quot;-&quot; + month + &quot;-&quot; + date + &quot; &quot; + hours + &quot;:&quot; + minute + &quot;:&quot; + second
  );
};

export function dateStr() {
  let date = new Date();
  if (date.getHours() &gt;= 0 &amp;&amp; date.getHours() &lt; 12) {
    return &quot;&#x4E0A;&#x5348;&#x597D;&quot;;
  } else if (date.getHours() &gt;= 12 &amp;&amp; date.getHours() &lt; 18) {
    return &quot;&#x4E0B;&#x5348;&#x597D;&quot;;
  } else {
    return &quot;&#x665A;&#x4E0A;&#x597D;&quot;;
  }
}

/**
 * &#x6821;&#x9A8C;&#x624B;&#x673A;&#x53F7;&#x662F;&#x5426;&#x6B63;&#x786E;
 * @param phone &#x624B;&#x673A;&#x53F7;
 */

export const verifyPhone = phone =&gt; {
  const reg = /^1[0-9]{10}$/;
  const _phone = phone.toString().trim();
  let toastStr =
    _phone === &quot;&quot;
      ? &quot;&#x624B;&#x673A;&#x53F7;&#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;~&quot;
      : !reg.test(_phone) &amp;&amp; &quot;&#x8BF7;&#x8F93;&#x5165;&#x6B63;&#x786E;&#x624B;&#x673A;&#x53F7;~&quot;;
  return {
    errMsg: toastStr,
    done: !toastStr,
    value: _phone
  };
};

export const verifyStr = (str, text) =&gt; {
  const _str = str.toString().trim();
  const toastStr = _str.length ? false : `&#x8BF7;&#x586B;&#x5199;${text}&#xFF5E;`;
  return {
    errMsg: toastStr,
    done: !toastStr,
    value: _str
  };
};

// &#x622A;&#x53D6;&#x5B57;&#x7B26;&#x4E32;

export const sliceStr = (str, sliceLen) =&gt; {
  if (!str) {
    return &quot;&quot;;
  }
  let realLength = 0;
  const len = str.length;
  let charCode = -1;
  for (var i = 0; i &lt; len; i++) {
    charCode = str.charCodeAt(i);
    if (charCode &gt;= 0 &amp;&amp; charCode &lt;= 128) {
      realLength += 1;
    } else {
      realLength += 2;
    }
    if (realLength &gt; sliceLen) {
      return `${str.slice(0, i)}...`;
    }
  }

  return str;
};

/**
 * JSON &#x514B;&#x9686;
 * @param {Object | Json} jsonObj json&#x5BF9;&#x8C61;
 * @return {Object | Json} &#x65B0;&#x7684;json&#x5BF9;&#x8C61;
 */
export function objClone(jsonObj) {
  var buf;
  if (jsonObj instanceof Array) {
    buf = [];
    var i = jsonObj.length;
    while (i--) {
      buf[i] = objClone(jsonObj[i]);
    }
    return buf;
  } else if (jsonObj instanceof Object) {
    buf = {};
    for (var k in jsonObj) {
      buf[k] = objClone(jsonObj[k]);
    }
    return buf;
  } else {
    return jsonObj;
  }
}

export function MD5withRSA(signMd5) {
  if (!Taro.getStorageSync(STORAGE_DATA.PRIVATEKEY)) return;
  const pem = `-----BEGIN PRIVATE KEY-----${Taro.getStorageSync(
    STORAGE_DATA.PRIVATEKEY
  )}-----END PRIVATE KEY-----`;

  let key = KEYUTIL.getKey(pem);
  // &#x521B;&#x5EFA; Signature &#x5BF9;&#x8C61;
  let signature = new KJUR.crypto.Signature({ alg: &quot;MD5withRSA&quot; });
  // &#x4F20;&#x5165;key&#x5B9E;&#x4F8B;, &#x521D;&#x59CB;&#x5316;signature&#x5B9E;&#x4F8B;
  signature.init(key);
  // &#x4F20;&#x5165;&#x5F85;&#x7B7E;&#x660E;&#x6587;
  signature.updateString(signMd5);
  const signInfo = signature.sign();
  const sign = hextob64(signInfo);
  console.log(&quot;signature:&quot;, signInfo, sign);
  // &#x7B7E;&#x540D;, &#x5F97;&#x5230;16&#x8FDB;&#x5236;&#x5B57;&#x7B26;&#x7ED3;&#x679C;
  return sign;
}

// &#x652F;&#x4ED8;md5&#x52A0;&#x5BC6;&#x83B7;&#x53D6;sign
export function signjs(jsonobj) {
  var signstr = obj2str(jsonobj);
  if (Taro.getStorageSync(STORAGE_DATA.USERID)) {
    signstr = signstr + &quot;&amp;key=&quot; + Taro.getStorageSync(STORAGE_DATA.USERID);
  }
  var sign = md5(signstr); //&#x9A8C;&#x8BC1;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x6216;&#x5FAE;&#x4FE1;&#x4E3B;&#x52A8;&#x901A;&#x77E5;&#x7B7E;&#x540D;&#x65F6;&#xFF0C;&#x4F20;&#x9001;&#x7684;sign&#x53C2;&#x6570;&#x4E0D;&#x53C2;&#x4E0E;&#x7B7E;&#x540D;&#xFF0C;&#x5C06;&#x751F;&#x6210;&#x7684;&#x7B7E;&#x540D;&#x4E0E;&#x8BE5;sign&#x503C;&#x4F5C;&#x6821;&#x9A8C;&#x3002;
  console.log(&quot;signstrkey:&quot;, signstr, signstr.length, sign, sign.toUpperCase());
  return sign.toUpperCase();
}

export function sortObj(obj) {
  if (obj instanceof Array) {
    let newArr = [];
    newArr = obj.map((item, index) =&gt; {
      return sortObj(item);
    });
    return newArr;
  } else if (obj instanceof Object) {
    let keys = Object.keys(obj);
    if (!(keys &amp;&amp; keys.length &gt; 0)) return null;
    keys = keys.sort(); //&#x53C2;&#x6570;&#x540D;ASCII&#x7801;&#x4ECE;&#x5C0F;&#x5230;&#x5927;&#x6392;&#x5E8F;&#xFF08;&#x5B57;&#x5178;&#x5E8F;&#xFF09;&#xFF1B;
    let newObj = {};
    keys.forEach(function(key) {
      if (obj[key] !== &quot;&quot; &amp;&amp; obj[key] !== undefined &amp;&amp; obj[key] !== null) {
        //&#x5982;&#x679C;&#x53C2;&#x6570;&#x7684;&#x503C;&#x4E3A;&#x7A7A;&#x4E0D;&#x53C2;&#x4E0E;&#x7B7E;&#x540D;&#xFF1B;
        newObj[key] = sortObj(obj[key]); //&#x53C2;&#x6570;&#x540D;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;&#xFF1B;
      }
    });
    return newObj;
  } else {
    return obj;
  }
}

//object&#x8F6C;string,&#x7528;&#x4E8E;&#x7B7E;&#x540D;&#x8BA1;&#x7B97;
export function obj2str(args) {
  if (!args) return;
  let newArgs = sortObj(args);
  console.log(&quot;sortObj\n&quot;, args, &quot;\n&quot;, newArgs);
  let string = &quot;&quot;;
  for (let k in newArgs) {
    string +=
      &quot;&amp;&quot; +
      k +
      &quot;=&quot; +
      (typeof newArgs[k] == &quot;object&quot; ? JSON.stringify(newArgs[k]) : newArgs[k]);
  }
  string = string.substr(1);
  return string;
}

//&#x968F;&#x673A;&#x51FD;&#x6570;&#x7684;&#x4EA7;&#x751F;&#xFF1A;
export function createNonceSt() {
  return Math.random()
    .toString(36)
    .substr(2, 15); //&#x968F;&#x673A;&#x5C0F;&#x6570;&#xFF0C;&#x8F6C;&#x6362;36&#x8FDB;&#x5236;&#xFF0C;&#x53BB;&#x6389;0.&#xFF0C;&#x4FDD;&#x7559;&#x4F59;&#x4E0B;&#x90E8;&#x5206;
}

//&#x65F6;&#x95F4;&#x6233;&#x4EA7;&#x751F;&#x7684;&#x51FD;&#x6570;, &#x5F53;&#x524D;&#x65F6;&#x95F4;&#x4EE5;&#x8BC1;&#x4E66;&#x8868;&#x8FBE;&#xFF0C;&#x7CBE;&#x786E;&#x5230;&#x79D2;&#x7684;&#x5B57;&#x7B26;&#x4E32;
export function createTimeStamp() {
  return parseInt(new Date().getTime() / 1000) + &quot;&quot;;
}

export function sort_ASCII(obj) {
  var arr = new Array();
  var num = 0;
  for (var i in obj) {
    arr[num] = i;
    num++;
  }
  var sortArr = arr.sort();
  var sortObj = {};
  for (var i in sortArr) {
    sortObj[sortArr[i]] = obj[sortArr[i]];
  }
  return sortObj;
}

/** &#x68C0;&#x67E5;&#x66F4;&#x65B0; */
export function checkForUpdate() {
  if (Taro.canIUse(&quot;getUpdateManager&quot;)) {
    const updateManager = Taro.getUpdateManager();
    updateManager.onCheckForUpdate(res =&gt; {
      // &#x8BF7;&#x6C42;&#x5B8C;&#x65B0;&#x7248;&#x672C;&#x4FE1;&#x606F;&#x7684;&#x56DE;&#x8C03;
      if (res.hasUpdate) {
        updateManager.onUpdateReady(() =&gt; {
          Taro.showModal({
            title: &quot;&#x66F4;&#x65B0;&#x63D0;&#x793A;&quot;,
            content: &quot;&#x65B0;&#x7248;&#x672C;&#x5DF2;&#x7ECF;&#x51C6;&#x5907;&#x597D;&#xFF0C;&#x662F;&#x5426;&#x91CD;&#x542F;&#x5E94;&#x7528;&#xFF1F;&quot;,
            showCancel: false,
            confirmColor: &quot;#40A3FF&quot;,
            success: res =&gt; {
              if (res.confirm) {
                // &#x65B0;&#x7684;&#x7248;&#x672C;&#x5DF2;&#x7ECF;&#x4E0B;&#x8F7D;&#x597D;&#xFF0C;&#x8C03;&#x7528; applyUpdate &#x5E94;&#x7528;&#x65B0;&#x7248;&#x672C;&#x5E76;&#x91CD;&#x542F;
                updateManager.applyUpdate();
              }
            }
          });
        });

        updateManager.onUpdateFailed(() =&gt; {
          // &#x65B0;&#x7248;&#x672C;&#x4E0B;&#x8F7D;&#x5931;&#x8D25;
          Taro.showModal({
            title: &quot;&#x66F4;&#x65B0;&#x63D0;&#x793A;&quot;,
            content: &quot;&#x65B0;&#x7248;&#x672C;&#x5DF2;&#x7ECF;&#x4E0A;&#x7EBF;&#xFF0C;&#x8BF7;&#x5220;&#x9664;&#x5F53;&#x524D;&#x5C0F;&#x7A0B;&#x5E8F;&#xFF0C;&#x91CD;&#x65B0;&#x626B;&#x7801;&#x8FDB;&#x5165;&quot;,
            confirmColor: &quot;#40A3FF&quot;,
            showCancel: false
          });
        });
      }
    });
  }
}
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="RN中场景一之RN和原生交互.html" class="navigation navigation-prev " aria-label="Previous page: RN中场景一之RN和原生交互">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Taro小程序dva框架开发学习.html" class="navigation navigation-next " aria-label="Next page: Taro小程序dva框架开发学习">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Taro小程序开发学习","level":"1.18","depth":1,"next":{"title":"Taro小程序dva框架开发学习","level":"1.19","depth":1,"path":"Taro小程序dva框架开发学习.md","ref":"Taro小程序dva框架开发学习.md","articles":[]},"previous":{"title":"RN中场景一之RN和原生交互","level":"1.17","depth":1,"path":"RN中场景一之RN和原生交互.md","ref":"RN中场景一之RN和原生交互.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Taro小程序开发学习.md","mtime":"2021-11-23T04:05:39.786Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-03-27T07:03:27.764Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

